#!/usr/bin/python
import sys
import imp

import Environment

class Project:
	def __init__( self, path ):
		env = Environment.Env()
		
		# Parse the project config file
		try:
			project = imp.load_source( 'project', path )
		except IOError:
			env.output.error( 'No project definition found' )

		# Set up our command line options		
		project.configure( env )
		project.build( env, env.args )

		# Output the makefile
		env.output.start( 'Writing makefile...' )
		env.make.write()
		env.output.success( 'done' )
	
def main():
	project = Project( './project.lupine' )

if __name__ == '__main__':
	main()
